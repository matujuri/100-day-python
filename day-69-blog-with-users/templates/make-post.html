{% from "bootstrap5/form.html" import render_form %} {% block content %} {%
include "header.html" %}

<!-- Page Header -->
<header
  class="masthead"
  style="background-image: url('../static/assets/img/edit-bg.jpg')"
>
  <div class="container position-relative px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
        <div class="page-heading">
          {% if is_edit: %}
          <h1>Edit Post</h1>
          {% else: %}
          <h1>New Post</h1>
          {% endif %}
          <span class="subheading"
            >You're going to make a great blog post!</span
          >
        </div>
      </div>
    </div>
  </div>
</header>

<main class="mb-4">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        {{ render_form(form, novalidate=True, button_map={"submit": "primary"}) }}
      </div>
    </div>
  </div>
</main>

<link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
<script>
  var quill;

  var commentForm = document.querySelector("form");
  var originalCommentTextArea = document.querySelector("textarea#body");

  if (originalCommentTextArea) {
    originalCommentTextArea.style.display = "none";
    originalCommentTextArea.removeAttribute("required");
    // Quillエディタのdivを作成し、元のtextareaの直前に挿入
    var quillEditorDiv = document.createElement("div");
    quillEditorDiv.id = "quill-container"; // 新しいユニークなID
    quillEditorDiv.style.height = "150px";
    originalCommentTextArea.parentNode.insertBefore(
      quillEditorDiv,
      originalCommentTextArea
    );
    quill = new Quill(quillEditorDiv, {
      theme: "snow",
    });
    quill.root.innerHTML = originalCommentTextArea.value;
  }

  commentForm.onsubmit = function () {
    if (originalCommentTextArea) {
      originalCommentTextArea.value = quill.root.innerHTML;
    }
  };
</script>
{% include "footer.html" %} {% endblock %}
